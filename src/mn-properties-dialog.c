/* Generated by GOB (v2.0.12) on Tue Aug  9 22:01:57 2005
   (do not edit directly) */

/* End world hunger, donate to the World Food Programme, http://www.wfp.org */

#define GOB_VERSION_MAJOR 2
#define GOB_VERSION_MINOR 0
#define GOB_VERSION_PATCHLEVEL 12

#define selfp (self->_priv)

#include <string.h> /* memset() */

#include "mn-properties-dialog.h"

#include "mn-properties-dialog-private.h"

#ifdef G_LIKELY
#define ___GOB_LIKELY(expr) G_LIKELY(expr)
#define ___GOB_UNLIKELY(expr) G_UNLIKELY(expr)
#else /* ! G_LIKELY */
#define ___GOB_LIKELY(expr) (expr)
#define ___GOB_UNLIKELY(expr) (expr)
#endif /* G_LIKELY */

#line 25 "mn-properties-dialog.gob"

#include "config.h"
#include <glib/gi18n.h>
#include <gtk/gtk.h>
#include <eel/eel.h>
#include "mn-conf.h"
#include "mn-util.h"
#include "mn-mailbox-view.h"
#include "mn-shell.h"
#include "mn-mail-summary-popup.h"
#include "mn-message.h"

enum
{
  POSITION_COLUMN_NICK,
  POSITION_COLUMN_LABEL,
  POSITION_N_COLUMNS
};

#line 47 "mn-properties-dialog.c"
/* self casting macros */
#define SELF(x) MN_PROPERTIES_DIALOG(x)
#define SELF_CONST(x) MN_PROPERTIES_DIALOG_CONST(x)
#define IS_SELF(x) MN_IS_PROPERTIES_DIALOG(x)
#define TYPE_SELF MN_TYPE_PROPERTIES_DIALOG
#define SELF_CLASS(x) MN_PROPERTIES_DIALOG_CLASS(x)

#define SELF_GET_CLASS(x) MN_PROPERTIES_DIALOG_GET_CLASS(x)

/* self typedefs */
typedef MNPropertiesDialog Self;
typedef MNPropertiesDialogClass SelfClass;

/* here are local prototypes */
static void mn_properties_dialog_class_init (MNPropertiesDialogClass * c) G_GNUC_UNUSED;
static void mn_properties_dialog_init (MNPropertiesDialog * self) G_GNUC_UNUSED;
static void mn_properties_dialog_response_h (MNPropertiesDialog * self, int response, gpointer user_data) G_GNUC_UNUSED;
static void mn_properties_dialog_add_position (GtkListStore * store, MNPosition position, const char * label) G_GNUC_UNUSED;
static void mn_properties_dialog_update_selected_label (MNPropertiesDialog * self) G_GNUC_UNUSED;
static void mn_properties_dialog_update_sensitivity (MNPropertiesDialog * self) G_GNUC_UNUSED;

/* pointer to the class of our parent */
static MNDialogClass *parent_class = NULL;

/* Short form macros */
#define self_response_h mn_properties_dialog_response_h
#define self_add_position mn_properties_dialog_add_position
#define self_update_selected_label mn_properties_dialog_update_selected_label
#define self_update_sensitivity mn_properties_dialog_update_sensitivity
#define self_test_popup_displayed mn_properties_dialog_test_popup_displayed
#define self_toggled_h mn_properties_dialog_toggled_h
#define self_autostart_toggled_h mn_properties_dialog_autostart_toggled_h
#define self_add_clicked_h mn_properties_dialog_add_clicked_h
#define self_remove_clicked_h mn_properties_dialog_remove_clicked_h
#define self_properties_clicked_h mn_properties_dialog_properties_clicked_h
#define self_summary_enable_toggled_h mn_properties_dialog_summary_enable_toggled_h
#define self_summary_test_button_clicked_h mn_properties_dialog_summary_test_button_clicked_h
GType
mn_properties_dialog_get_type (void)
{
	static GType type = 0;

	if ___GOB_UNLIKELY(type == 0) {
		static const GTypeInfo info = {
			sizeof (MNPropertiesDialogClass),
			(GBaseInitFunc) NULL,
			(GBaseFinalizeFunc) NULL,
			(GClassInitFunc) mn_properties_dialog_class_init,
			(GClassFinalizeFunc) NULL,
			NULL /* class_data */,
			sizeof (MNPropertiesDialog),
			0 /* n_preallocs */,
			(GInstanceInitFunc) mn_properties_dialog_init,
			NULL
		};

		type = g_type_register_static (MN_TYPE_DIALOG, "MNPropertiesDialog", &info, (GTypeFlags)0);
	}

	return type;
}

/* a macro for creating a new object of our type */
#define GET_NEW ((MNPropertiesDialog *)g_object_new(mn_properties_dialog_get_type(), NULL))

/* a function for creating a new object of our type */
#include <stdarg.h>
static MNPropertiesDialog * GET_NEW_VARG (const char *first, ...) G_GNUC_UNUSED;
static MNPropertiesDialog *
GET_NEW_VARG (const char *first, ...)
{
	MNPropertiesDialog *ret;
	va_list ap;
	va_start (ap, first);
	ret = (MNPropertiesDialog *)g_object_new_valist (mn_properties_dialog_get_type (), first, ap);
	va_end (ap);
	return ret;
}


static void
___finalize(GObject *obj_self)
{
#define __GOB_FUNCTION__ "MN:Properties:Dialog::finalize"
	MNPropertiesDialog *self G_GNUC_UNUSED = MN_PROPERTIES_DIALOG (obj_self);
	gpointer priv G_GNUC_UNUSED = self->_priv;
	if(G_OBJECT_CLASS(parent_class)->finalize) \
		(* G_OBJECT_CLASS(parent_class)->finalize)(obj_self);
#define test_popup (self->_priv->test_popup)
#define VAR test_popup
	{
#line 103 "mn-properties-dialog.gob"
	
      if (VAR)
	{
	  g_object_weak_unref(G_OBJECT(VAR), (GWeakNotify) self_update_sensitivity, self);
	  gtk_widget_destroy(VAR);
	}
    }
#line 147 "mn-properties-dialog.c"
	memset(&test_popup, 0, sizeof(test_popup));
#undef VAR
#undef test_popup
}
#undef __GOB_FUNCTION__

static void 
mn_properties_dialog_class_init (MNPropertiesDialogClass * c G_GNUC_UNUSED)
{
#define __GOB_FUNCTION__ "MN:Properties:Dialog::class_init"
	GObjectClass *g_object_class G_GNUC_UNUSED = (GObjectClass*) c;

	g_type_class_add_private(c,sizeof(MNPropertiesDialogPrivate));

	parent_class = g_type_class_ref (MN_TYPE_DIALOG);

	g_object_class->finalize = ___finalize;
}
#undef __GOB_FUNCTION__
#line 111 "mn-properties-dialog.gob"
static void 
mn_properties_dialog_init (MNPropertiesDialog * self G_GNUC_UNUSED)
#line 170 "mn-properties-dialog.c"
{
#define __GOB_FUNCTION__ "MN:Properties:Dialog::init"
	self->_priv = G_TYPE_INSTANCE_GET_PRIVATE(self,MN_TYPE_PROPERTIES_DIALOG,MNPropertiesDialogPrivate);
 {
#line 112 "mn-properties-dialog.gob"

    GtkSizeGroup *size_group;
    GtkTreeSelection *selection;
    GtkListStore *position_store;
    GtkCellRenderer *renderer;

    mn_container_create_interface(GTK_CONTAINER(self),
				  MN_INTERFACE_FILE("properties-dialog.glade"),
				  "notebook",
				  "mn_properties_dialog_",
				  "notebook", &selfp->notebook,
				  "autostart_check", &selfp->autostart_check,
				  "blink_check", &selfp->blink_check,
				  "summary_tooltip_check", &selfp->summary_tooltip_check,
				  "command_mail_reader_check", &selfp->command_mail_reader_check,
				  "command_mail_reader_entry", &selfp->command_mail_reader_entry,
				  "command_new_mail_check", &selfp->command_new_mail_check,
				  "command_new_mail_entry", &selfp->command_new_mail_entry,
				  "command_mail_read_check", &selfp->command_mail_read_check,
				  "command_mail_read_entry", &selfp->command_mail_read_entry,
				  "action_main_window_radio", &selfp->action_main_window_radio,
				  "action_mail_reader_radio", &selfp->action_mail_reader_radio,
				  "action_update_radio", &selfp->action_update_radio,
				  "delay_label", &selfp->delay_label,
				  "minutes_spin", &selfp->minutes_spin,
				  "minutes_label", &selfp->minutes_label,
				  "seconds_spin", &selfp->seconds_spin,
				  "seconds_label", &selfp->seconds_label,
				  "scrolled", &selfp->scrolled,
				  "selected_label", &selfp->selected_label,
				  "remove", &selfp->remove,
				  "properties", &selfp->properties,
				  "summary_enable_check", &selfp->summary_enable_check,
				  "summary_autoclose_check", &selfp->summary_autoclose_check,
				  "summary_minutes_spin", &selfp->summary_minutes_spin,
				  "summary_minutes_label", &selfp->summary_minutes_label,
				  "summary_seconds_spin", &selfp->summary_seconds_spin,
				  "summary_seconds_label", &selfp->summary_seconds_label,
				  "summary_only_recent_check", &selfp->summary_only_recent_check,
				  "summary_position_label", &selfp->summary_position_label,
				  "summary_position_combo", &selfp->summary_position_combo,
				  "summary_horizontal_offset_label", &selfp->summary_horizontal_offset_label,
				  "summary_horizontal_offset_spin", &selfp->summary_horizontal_offset_spin,
				  "summary_horizontal_pixels_label", &selfp->summary_horizontal_pixels_label,
				  "summary_vertical_offset_label", &selfp->summary_vertical_offset_label,
				  "summary_vertical_offset_spin", &selfp->summary_vertical_offset_spin,
				  "summary_vertical_pixels_label", &selfp->summary_vertical_pixels_label,
				  "summary_fonts_from_theme_radio", &selfp->summary_fonts_from_theme_radio,
				  "summary_custom_fonts_radio", &selfp->summary_custom_fonts_radio,
				  "summary_title_font_alignment", &selfp->summary_title_font_alignment,
				  "summary_title_font_label", &selfp->summary_title_font_label,
				  "summary_title_font_button", &selfp->summary_title_font_button,
				  "summary_contents_font_alignment", &selfp->summary_contents_font_alignment,
				  "summary_contents_font_label", &selfp->summary_contents_font_label,
				  "summary_contents_font_button", &selfp->summary_contents_font_button,
				  "summary_test_button", &selfp->summary_test_button,
				  NULL);

    gtk_window_set_title(GTK_WINDOW(self), _("Mail Notification Properties"));
    gtk_dialog_add_buttons(GTK_DIALOG(self),
			   GTK_STOCK_HELP, GTK_RESPONSE_HELP,
			   GTK_STOCK_CLOSE, GTK_RESPONSE_CLOSE,
			   NULL);

    selfp->list = mn_mailbox_view_new();
    gtk_container_add(GTK_CONTAINER(selfp->scrolled), selfp->list);
    gtk_widget_show(selfp->list);

    selection = gtk_tree_view_get_selection(GTK_TREE_VIEW(selfp->list));
    g_object_connect(selection,
		     "swapped-signal::changed", self_update_selected_label, self,
		     "swapped-signal::changed", self_update_sensitivity, self,
		     NULL);
  
    mn_setup_dnd(selfp->scrolled);

    size_group = gtk_size_group_new(GTK_SIZE_GROUP_HORIZONTAL);
    gtk_size_group_add_widget(size_group, selfp->command_mail_reader_check);
    gtk_size_group_add_widget(size_group, selfp->command_new_mail_check);
    gtk_size_group_add_widget(size_group, selfp->command_mail_read_check);
    g_object_unref(size_group);
  
    size_group = gtk_size_group_new(GTK_SIZE_GROUP_HORIZONTAL);
    gtk_size_group_add_widget(size_group, selfp->summary_autoclose_check);
    gtk_size_group_add_widget(size_group, selfp->summary_position_label);
    gtk_size_group_add_widget(size_group, selfp->summary_horizontal_offset_label);
    gtk_size_group_add_widget(size_group, selfp->summary_vertical_offset_label);
    gtk_size_group_add_widget(size_group, selfp->summary_title_font_alignment);
    gtk_size_group_add_widget(size_group, selfp->summary_contents_font_alignment);
    g_object_unref(size_group);

    gtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(selfp->autostart_check), mn_conf_get_autostart());

    position_store = gtk_list_store_new(POSITION_N_COLUMNS, G_TYPE_STRING, G_TYPE_STRING);

    self_add_position(position_store, MN_POSITION_TOP_LEFT, _("top left"));
    self_add_position(position_store, MN_POSITION_TOP_RIGHT, _("top right"));
    self_add_position(position_store, MN_POSITION_BOTTOM_LEFT, _("bottom left"));
    self_add_position(position_store, MN_POSITION_BOTTOM_RIGHT, _("bottom right"));

    renderer = gtk_cell_renderer_text_new();
    gtk_cell_layout_pack_start(GTK_CELL_LAYOUT(selfp->summary_position_combo), renderer, TRUE);
    gtk_cell_layout_set_attributes(GTK_CELL_LAYOUT(selfp->summary_position_combo), renderer,
				   "text", POSITION_COLUMN_LABEL,
				   NULL);

    gtk_combo_box_set_model(GTK_COMBO_BOX(selfp->summary_position_combo), GTK_TREE_MODEL(position_store));
    g_object_unref(position_store);
  
    mn_conf_link(self, MN_CONF_PROPERTIES_DIALOG,
		 selfp->blink_check, MN_CONF_BLINK_ON_ERRORS, "active",
		 selfp->summary_tooltip_check, MN_CONF_SUMMARY_TOOLTIP, "active",
		 selfp->command_mail_reader_check, MN_CONF_COMMANDS_MAIL_READER_ENABLED, "active",
		 selfp->command_mail_reader_entry, MN_CONF_COMMANDS_MAIL_READER_COMMAND, "text",
		 selfp->command_new_mail_check, MN_CONF_COMMANDS_NEW_MAIL_ENABLED, "active",
		 selfp->command_new_mail_entry, MN_CONF_COMMANDS_NEW_MAIL_COMMAND, "text",
		 selfp->command_mail_read_check, MN_CONF_COMMANDS_MAIL_READ_ENABLED, "active",
		 selfp->command_mail_read_entry, MN_CONF_COMMANDS_MAIL_READ_COMMAND, "text",
		 selfp->minutes_spin, MN_CONF_DELAY_MINUTES,
		 selfp->seconds_spin, MN_CONF_DELAY_SECONDS,
		 selfp->summary_enable_check, MN_CONF_MAIL_SUMMARY_POPUP_ENABLE, "active",
		 selfp->summary_autoclose_check, MN_CONF_MAIL_SUMMARY_POPUP_AUTOCLOSE, "active",
		 selfp->summary_minutes_spin, MN_CONF_MAIL_SUMMARY_POPUP_AUTOCLOSE_DELAY_MINUTES,
		 selfp->summary_seconds_spin, MN_CONF_MAIL_SUMMARY_POPUP_AUTOCLOSE_DELAY_SECONDS,
		 selfp->summary_only_recent_check, MN_CONF_MAIL_SUMMARY_POPUP_ONLY_RECENT, "active",
		 selfp->summary_horizontal_offset_spin, MN_CONF_MAIL_SUMMARY_POPUP_HORIZONTAL_OFFSET,
		 selfp->summary_vertical_offset_spin, MN_CONF_MAIL_SUMMARY_POPUP_VERTICAL_OFFSET,
		 selfp->summary_title_font_button, MN_CONF_MAIL_SUMMARY_POPUP_FONTS_TITLE_FONT, "font-name",
		 selfp->summary_contents_font_button, MN_CONF_MAIL_SUMMARY_POPUP_FONTS_CONTENTS_FONT, "font-name",
		 NULL);
    mn_conf_link_radio_group_to_enum(MN_TYPE_ACTION,
				     MN_CONF_DOUBLE_CLICK_ACTION_2,
				     selfp->action_main_window_radio, MN_ACTION_DISPLAY_MAIN_WINDOW,
				     selfp->action_mail_reader_radio, MN_ACTION_LAUNCH_MAIL_READER,
				     selfp->action_update_radio, MN_ACTION_UPDATE_MAIL_STATUS,
				     NULL);
    mn_conf_link_radio_group_to_enum(MN_TYPE_ASPECT_SOURCE,
				     MN_CONF_MAIL_SUMMARY_POPUP_FONTS_ASPECT_SOURCE,
				     selfp->summary_fonts_from_theme_radio, MN_ASPECT_SOURCE_THEME,
				     selfp->summary_custom_fonts_radio, MN_ASPECT_SOURCE_CUSTOM,
				     NULL);
    mn_conf_link_combo_box_to_string(GTK_COMBO_BOX(selfp->summary_position_combo),
				     POSITION_COLUMN_NICK,
				     MN_CONF_MAIL_SUMMARY_POPUP_POSITION);

    self_update_selected_label(self);
    self_update_sensitivity(self);

    mn_g_object_connect(self,
			mn_shell->mailboxes,
			"swapped-signal::notify::must-poll", self_update_sensitivity, self,
			NULL);

    g_signal_connect(self, "response", G_CALLBACK(self_response_h), NULL);
  
#line 331 "mn-properties-dialog.c"
 }
}
#undef __GOB_FUNCTION__



#line 268 "mn-properties-dialog.gob"
static void 
mn_properties_dialog_response_h (MNPropertiesDialog * self, int response, gpointer user_data)
#line 341 "mn-properties-dialog.c"
{
#define __GOB_FUNCTION__ "MN:Properties:Dialog::response_h"
#line 268 "mn-properties-dialog.gob"
	g_return_if_fail (self != NULL);
#line 268 "mn-properties-dialog.gob"
	g_return_if_fail (MN_IS_PROPERTIES_DIALOG (self));
#line 348 "mn-properties-dialog.c"
{
#line 270 "mn-properties-dialog.gob"
	
    switch (response)
      {
      case GTK_RESPONSE_HELP:
	{
	  int current_page;
	  const char *sections[] = {
	    "properties-general",
	    "properties-mailboxes",
	    "properties-mail-summary-popup"
	  };
	
	  current_page = gtk_notebook_get_current_page(GTK_NOTEBOOK(selfp->notebook));
	  g_return_if_fail(current_page >= 0 && current_page < G_N_ELEMENTS(sections));

	  mn_display_help(GTK_WINDOW(self), sections[current_page]);
	  break;
	}
    
      case GTK_RESPONSE_CLOSE:
	gtk_widget_destroy(GTK_WIDGET(self));
	break;
      }
  }}
#line 375 "mn-properties-dialog.c"
#undef __GOB_FUNCTION__

#line 295 "mn-properties-dialog.gob"
static void 
mn_properties_dialog_add_position (GtkListStore * store, MNPosition position, const char * label)
#line 381 "mn-properties-dialog.c"
{
#define __GOB_FUNCTION__ "MN:Properties:Dialog::add_position"
#line 295 "mn-properties-dialog.gob"
	g_return_if_fail (store != NULL);
#line 295 "mn-properties-dialog.gob"
	g_return_if_fail (GTK_IS_LIST_STORE (store));
#line 295 "mn-properties-dialog.gob"
	g_return_if_fail (label != NULL);
#line 390 "mn-properties-dialog.c"
{
#line 299 "mn-properties-dialog.gob"
	
    GEnumClass *enum_class;
    GEnumValue *enum_value;
    GtkTreeIter iter;

    enum_class = g_type_class_ref(MN_TYPE_POSITION);
    g_return_if_fail(enum_class != NULL);

    enum_value = g_enum_get_value(enum_class, position);
    g_return_if_fail(enum_value != NULL);

    gtk_list_store_append(store, &iter);
    gtk_list_store_set(store, &iter,
		       POSITION_COLUMN_NICK, enum_value->value_nick,
		       POSITION_COLUMN_LABEL, label,
		       -1);

    g_type_class_unref(enum_class);
  }}
#line 412 "mn-properties-dialog.c"
#undef __GOB_FUNCTION__

#line 319 "mn-properties-dialog.gob"
static void 
mn_properties_dialog_update_selected_label (MNPropertiesDialog * self)
#line 418 "mn-properties-dialog.c"
{
#define __GOB_FUNCTION__ "MN:Properties:Dialog::update_selected_label"
#line 319 "mn-properties-dialog.gob"
	g_return_if_fail (self != NULL);
#line 319 "mn-properties-dialog.gob"
	g_return_if_fail (MN_IS_PROPERTIES_DIALOG (self));
#line 425 "mn-properties-dialog.c"
{
#line 321 "mn-properties-dialog.gob"
	
    GtkTreeSelection *selection;
    int n_rows;

    selection = gtk_tree_view_get_selection(GTK_TREE_VIEW(selfp->list));
    n_rows = gtk_tree_selection_count_selected_rows(selection);

    if (n_rows == 0)
      gtk_label_set_text(GTK_LABEL(selfp->selected_label), _("No mailbox selected."));
    else
      {
	char *str;

	str = g_strdup_printf(ngettext("%i mailbox selected.",
				       "%i mailboxes selected.",
				       n_rows), n_rows);
	gtk_label_set_text(GTK_LABEL(selfp->selected_label), str);
	g_free(str);
      }
  }}
#line 448 "mn-properties-dialog.c"
#undef __GOB_FUNCTION__

#line 342 "mn-properties-dialog.gob"
static void 
mn_properties_dialog_update_sensitivity (MNPropertiesDialog * self)
#line 454 "mn-properties-dialog.c"
{
#define __GOB_FUNCTION__ "MN:Properties:Dialog::update_sensitivity"
#line 342 "mn-properties-dialog.gob"
	g_return_if_fail (self != NULL);
#line 342 "mn-properties-dialog.gob"
	g_return_if_fail (MN_IS_PROPERTIES_DIALOG (self));
#line 461 "mn-properties-dialog.c"
{
#line 344 "mn-properties-dialog.gob"
	
    gboolean command_mail_reader_enabled;
    gboolean command_new_mail_enabled;
    gboolean command_mail_read_enabled;
    gboolean must_poll;
    GtkTreeSelection *selection;
    gboolean has_selection;
    gboolean summary_enabled;
    gboolean summary_autoclose_enabled;
    gboolean summary_custom_fonts_enabled;

    command_mail_reader_enabled = gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(selfp->command_mail_reader_check));
    command_new_mail_enabled = gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(selfp->command_new_mail_check));
    command_mail_read_enabled = gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(selfp->command_mail_read_check));

    gtk_widget_set_sensitive(selfp->command_mail_reader_entry, command_mail_reader_enabled);
    gtk_widget_set_sensitive(selfp->command_new_mail_entry, command_new_mail_enabled);
    gtk_widget_set_sensitive(selfp->command_mail_read_entry, command_mail_read_enabled);

    must_poll = mn_mailboxes_get_must_poll(mn_shell->mailboxes);
    gtk_widget_set_sensitive(selfp->delay_label, must_poll);
    gtk_widget_set_sensitive(selfp->minutes_spin, must_poll);
    gtk_widget_set_sensitive(selfp->minutes_label, must_poll);
    gtk_widget_set_sensitive(selfp->seconds_spin, must_poll);
    gtk_widget_set_sensitive(selfp->seconds_label, must_poll);

    selection = gtk_tree_view_get_selection(GTK_TREE_VIEW(selfp->list));
    has_selection = gtk_tree_selection_count_selected_rows(selection) > 0;

    gtk_widget_set_sensitive(selfp->remove, has_selection);
    gtk_widget_set_sensitive(selfp->properties, has_selection);

    summary_enabled = gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(selfp->summary_enable_check));
    summary_autoclose_enabled = gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(selfp->summary_autoclose_check));
    summary_custom_fonts_enabled = gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(selfp->summary_custom_fonts_radio));

    gtk_widget_set_sensitive(selfp->summary_autoclose_check, summary_enabled);
    gtk_widget_set_sensitive(selfp->summary_minutes_spin, summary_enabled && summary_autoclose_enabled);
    gtk_widget_set_sensitive(selfp->summary_minutes_label, summary_enabled && summary_autoclose_enabled);
    gtk_widget_set_sensitive(selfp->summary_seconds_spin, summary_enabled && summary_autoclose_enabled);
    gtk_widget_set_sensitive(selfp->summary_seconds_label, summary_enabled && summary_autoclose_enabled);
    gtk_widget_set_sensitive(selfp->summary_only_recent_check, summary_enabled);
    gtk_widget_set_sensitive(selfp->summary_position_label, summary_enabled);
    gtk_widget_set_sensitive(selfp->summary_position_combo, summary_enabled);
    gtk_widget_set_sensitive(selfp->summary_horizontal_offset_label, summary_enabled);
    gtk_widget_set_sensitive(selfp->summary_horizontal_offset_spin, summary_enabled);
    gtk_widget_set_sensitive(selfp->summary_horizontal_pixels_label, summary_enabled);
    gtk_widget_set_sensitive(selfp->summary_vertical_offset_label, summary_enabled);
    gtk_widget_set_sensitive(selfp->summary_vertical_offset_spin, summary_enabled);
    gtk_widget_set_sensitive(selfp->summary_vertical_pixels_label, summary_enabled);
    gtk_widget_set_sensitive(selfp->summary_fonts_from_theme_radio, summary_enabled);
    gtk_widget_set_sensitive(selfp->summary_custom_fonts_radio, summary_enabled);
    gtk_widget_set_sensitive(selfp->summary_title_font_label, summary_enabled && summary_custom_fonts_enabled);
    gtk_widget_set_sensitive(selfp->summary_title_font_button, summary_enabled && summary_custom_fonts_enabled);
    gtk_widget_set_sensitive(selfp->summary_contents_font_label, summary_enabled && summary_custom_fonts_enabled);
    gtk_widget_set_sensitive(selfp->summary_contents_font_button, summary_enabled && summary_custom_fonts_enabled);
    gtk_widget_set_sensitive(selfp->summary_test_button, summary_enabled && ! selfp->test_popup);
  }}
#line 522 "mn-properties-dialog.c"
#undef __GOB_FUNCTION__

#line 403 "mn-properties-dialog.gob"
gboolean 
mn_properties_dialog_test_popup_displayed (MNPropertiesDialog * self)
#line 528 "mn-properties-dialog.c"
{
#define __GOB_FUNCTION__ "MN:Properties:Dialog::test_popup_displayed"
#line 403 "mn-properties-dialog.gob"
	g_return_val_if_fail (self != NULL, (gboolean )0);
#line 403 "mn-properties-dialog.gob"
	g_return_val_if_fail (MN_IS_PROPERTIES_DIALOG (self), (gboolean )0);
#line 535 "mn-properties-dialog.c"
{
#line 405 "mn-properties-dialog.gob"
	
    return selfp->test_popup != NULL;
  }}
#line 541 "mn-properties-dialog.c"
#undef __GOB_FUNCTION__

#line 411 "mn-properties-dialog.gob"
void 
mn_properties_dialog_toggled_h (MNPropertiesDialog * self, GtkToggleButton * button)
#line 547 "mn-properties-dialog.c"
{
#define __GOB_FUNCTION__ "MN:Properties:Dialog::toggled_h"
#line 411 "mn-properties-dialog.gob"
	g_return_if_fail (self != NULL);
#line 411 "mn-properties-dialog.gob"
	g_return_if_fail (MN_IS_PROPERTIES_DIALOG (self));
#line 554 "mn-properties-dialog.c"
{
#line 413 "mn-properties-dialog.gob"
	
    self_update_sensitivity(self);
  }}
#line 560 "mn-properties-dialog.c"
#undef __GOB_FUNCTION__

#line 417 "mn-properties-dialog.gob"
void 
mn_properties_dialog_autostart_toggled_h (MNPropertiesDialog * self, GtkToggleButton * togglebutton)
#line 566 "mn-properties-dialog.c"
{
#define __GOB_FUNCTION__ "MN:Properties:Dialog::autostart_toggled_h"
#line 417 "mn-properties-dialog.gob"
	g_return_if_fail (self != NULL);
#line 417 "mn-properties-dialog.gob"
	g_return_if_fail (MN_IS_PROPERTIES_DIALOG (self));
#line 573 "mn-properties-dialog.c"
{
#line 419 "mn-properties-dialog.gob"
	
    mn_conf_set_autostart(gtk_toggle_button_get_active(togglebutton));
  }}
#line 579 "mn-properties-dialog.c"
#undef __GOB_FUNCTION__

#line 423 "mn-properties-dialog.gob"
void 
mn_properties_dialog_add_clicked_h (MNPropertiesDialog * self, GtkButton * button)
#line 585 "mn-properties-dialog.c"
{
#define __GOB_FUNCTION__ "MN:Properties:Dialog::add_clicked_h"
#line 423 "mn-properties-dialog.gob"
	g_return_if_fail (self != NULL);
#line 423 "mn-properties-dialog.gob"
	g_return_if_fail (MN_IS_PROPERTIES_DIALOG (self));
#line 592 "mn-properties-dialog.c"
{
#line 425 "mn-properties-dialog.gob"
	
    mn_mailbox_view_activate_add(MN_MAILBOX_VIEW(selfp->list));
  }}
#line 598 "mn-properties-dialog.c"
#undef __GOB_FUNCTION__

#line 429 "mn-properties-dialog.gob"
void 
mn_properties_dialog_remove_clicked_h (MNPropertiesDialog * self, GtkButton * button)
#line 604 "mn-properties-dialog.c"
{
#define __GOB_FUNCTION__ "MN:Properties:Dialog::remove_clicked_h"
#line 429 "mn-properties-dialog.gob"
	g_return_if_fail (self != NULL);
#line 429 "mn-properties-dialog.gob"
	g_return_if_fail (MN_IS_PROPERTIES_DIALOG (self));
#line 611 "mn-properties-dialog.c"
{
#line 431 "mn-properties-dialog.gob"
	
    mn_mailbox_view_activate_remove(MN_MAILBOX_VIEW(selfp->list));
  }}
#line 617 "mn-properties-dialog.c"
#undef __GOB_FUNCTION__

#line 435 "mn-properties-dialog.gob"
void 
mn_properties_dialog_properties_clicked_h (MNPropertiesDialog * self, GtkButton * button)
#line 623 "mn-properties-dialog.c"
{
#define __GOB_FUNCTION__ "MN:Properties:Dialog::properties_clicked_h"
#line 435 "mn-properties-dialog.gob"
	g_return_if_fail (self != NULL);
#line 435 "mn-properties-dialog.gob"
	g_return_if_fail (MN_IS_PROPERTIES_DIALOG (self));
#line 630 "mn-properties-dialog.c"
{
#line 437 "mn-properties-dialog.gob"
	
    mn_mailbox_view_activate_properties(MN_MAILBOX_VIEW(selfp->list));
  }}
#line 636 "mn-properties-dialog.c"
#undef __GOB_FUNCTION__

#line 441 "mn-properties-dialog.gob"
void 
mn_properties_dialog_summary_enable_toggled_h (MNPropertiesDialog * self, GtkToggleButton * button)
#line 642 "mn-properties-dialog.c"
{
#define __GOB_FUNCTION__ "MN:Properties:Dialog::summary_enable_toggled_h"
#line 441 "mn-properties-dialog.gob"
	g_return_if_fail (self != NULL);
#line 441 "mn-properties-dialog.gob"
	g_return_if_fail (MN_IS_PROPERTIES_DIALOG (self));
#line 649 "mn-properties-dialog.c"
{
#line 443 "mn-properties-dialog.gob"
	
    self_update_sensitivity(self);

    if (selfp->test_popup && ! gtk_toggle_button_get_active(button))
      gtk_widget_destroy(selfp->test_popup);
  }}
#line 658 "mn-properties-dialog.c"
#undef __GOB_FUNCTION__

#line 450 "mn-properties-dialog.gob"
void 
mn_properties_dialog_summary_test_button_clicked_h (MNPropertiesDialog * self, GtkButton * button)
#line 664 "mn-properties-dialog.c"
{
#define __GOB_FUNCTION__ "MN:Properties:Dialog::summary_test_button_clicked_h"
#line 450 "mn-properties-dialog.gob"
	g_return_if_fail (self != NULL);
#line 450 "mn-properties-dialog.gob"
	g_return_if_fail (MN_IS_PROPERTIES_DIALOG (self));
#line 671 "mn-properties-dialog.c"
{
#line 452 "mn-properties-dialog.gob"
	
    GSList *messages = NULL;
    time_t now;
    int i;

    now = mn_time();
    selfp->test_popup = mn_mail_summary_popup_new();

    for (i = 1; i < 4; i++)
      {
	MNMessage *message;
	char *subject;

	subject = g_strdup_printf(_("Test message #%i"), i);
	message = mn_message_new(NULL,
				 NULL,
				 now,
				 NULL,
				 _("Mail Notification Properties Dialog"),
				 subject);
	g_free(subject);

	messages = g_slist_append(messages, message);
      }

    mn_mail_summary_popup_set_messages(MN_MAIL_SUMMARY_POPUP(selfp->test_popup), messages);
    mn_g_object_slist_free(messages);

    eel_add_weak_pointer(&selfp->test_popup);
    g_object_weak_ref(G_OBJECT(selfp->test_popup), (GWeakNotify) self_update_sensitivity, self);

    /* close the real mail summary popup if any */
    mn_shell_close_mail_summary_popup(mn_shell);

    self_update_sensitivity(self);
    gtk_widget_show(selfp->test_popup);
  }}
#line 711 "mn-properties-dialog.c"
#undef __GOB_FUNCTION__
